<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kg.seeot.mybatis.product.ProductMapper">

	<resultMap type="com.kg.seeot.product.dto.ProductDTO" id="product">
		<id property="productNo" column="product_no" />
		<result property="productName" column="product_name"/>
		<result property="productPrice" column="product_price"/>
		<result property="productFile" column="product_file"/>
		<result property="productCategorie" column="product_categorie"/>
		<result property="productDate" column="product_date"/>
		<result property="reviewCount" column="review_count"/>
		<result property="productRating" column="product_rating"/>
		<result property="productContent" column="product_content"/>
	</resultMap>
	
	<resultMap type="com.kg.seeot.product.dto.ProductManageDTO" id="product_management">
		<id property="productNo" column="product_no" />
		<result property="productStack" column="product_stack"/>
		<result property="productSize" column="product_size"/>
		<result property="productColor" column="product_color"/>
	</resultMap>
	
       
	<select id="allList" resultMap="product">
		select * from product
	</select>
	
	<select id="list" resultMap="product">
		select * from product where product_categorie = #{productCategorie}
	</select>
	
	<select id="productView" resultMap="product">
		select * from product where product_no = #{productNo}
	</select>
	
	<select id="managementSize" resultMap="product_management">
		select distinct product_size from product_management where product_no = #{productNo}
	</select>
	
	<select id="managementColor" resultMap="product_management">
		select distinct product_color from product_management where product_no = #{productNo}
	</select>
	
	<select id="productManageView" resultMap="product_management">
		select * from product_management where product_no = #{productNo} order by product_size
	</select>
	
	<insert id="productSave">
		insert into product(product_no, product_name, product_price, product_file, product_categorie, product_date, product_content)
			 values(#{productNo}, #{productName}, #{productPrice}, #{productFile}, #{productCategorie}, sysdate, #{productContent})
	</insert>
	
	<insert id="productManageSave">
		insert into product_management(product_no, product_stack, product_size, product_color)
			 values(#{productNo}, #{productStack}, #{productSize}, #{productColor})
	</insert>
	
	<delete id="productDelete">
		delete from product where product_no = #{productNo}
	</delete>
	
	<update id="productModify">
		update product set product_name=#{productName}, product_price=#{productPrice}, product_file=#{productFile}, product_categorie=#{productCategorie}, product_content=#{productContent}  where product_no = #{productNo}
	</update>
	
	<delete id="managementDelete">
		delete from product_management where product_no=#{productNo} and product_size=#{productSize} and product_color=#{productColor}
	</delete>
	
	<select id="managementModify_Form" resultMap="product_management">
		select * from product_management where product_no=#{productNo} and product_size=#{productSize} and product_color=#{productColor}
	</select>
	
	<update id="managementModify">
		update product_management set product_stack=#{moProductStack}, product_size=#{moProductSize}, product_color=#{moProductColor} where product_no=#{productNo} and product_stack=#{productStack} and product_size=#{productSize} and product_color=#{productColor}
	</update>
	
	<select id="proList" resultMap="product">
		select * from product 
			<if test="productCategorie != 0">
				where product_categorie = #{productCategorie} 
			</if>
		 	<choose>
 				<when test="orderBy.equals('redate')">
					order by product_date desc
				</when>
				<when test="orderBy.equals('hprice')">
					order by product_price desc, product_date desc
				</when>
		 		<when test="orderBy.equals('lprice')">
					order by product_price asc, product_date desc
				</when>
				<when test="orderBy.equals('rating')">
					order by product_rating desc, product_date desc
				</when>
				<when test="orderBy.equals('review')">
					order by review_count desc, product_date desc
				</when>
			</choose>
	</select>
	
</mapper>